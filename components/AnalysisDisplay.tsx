import React, { useState } from 'react';
import jsPDF from 'jspdf';
import { SkinAnalysisData } from '../types';
import SkinCharacteristicCard from './SkinCharacteristicCard'; //
import SkincareRoutineSection from './SkincareRoutineSection';
import ProductRecommendationCard from './ProductRecommendationCard';
import WellnessTipCard from './WellnessTipCard'; //
import { ChevronDownIcon, InfoIcon, DownloadIcon } from './icons'; //
import { useTranslation } from '../contexts/LanguageContext';
// IMPORTS NECESARIOS:
import { Filesystem, Directory } from '@capacitor/filesystem';
import { Capacitor } from '@capacitor/core';
import { FileOpener } from '@capacitor-community/file-opener'; // <--- NUEVO IMPORT AQUÍ


interface AnalysisDisplayProps {
  analysisData: SkinAnalysisData;
  onReset: () => void;
}

interface AccordionSectionProps {
  titleKey: string;
  icon?: React.ReactNode;
  children: React.ReactNode;
}

const AccordionSection: React.FC<AccordionSectionProps> = ({ titleKey, icon, children }) => {
  const { t } = useTranslation();
  const [isOpen, setIsOpen] = useState(true);
  const title = t(titleKey);

  return (
    <div className="mb-4 bg-white dark:bg-gray-800 rounded-xl shadow-lg transition-all duration-300">
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="w-full flex justify-between items-center p-4 text-left text-lg sm:text-xl font-semibold text-gray-800 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-t-xl"
        aria-expanded={isOpen}
        aria-controls={`accordion-content-${title.replace(/\s+/g, '-')}`}
      >
        <div className="flex items-center space-x-2">
          {icon}
          <span>{title}</span>
        </div>
        <ChevronDownIcon className={`w-5 h-5 sm:w-6 sm:h-6 transform transition-transform duration-200 ${isOpen ? 'rotate-180' : ''}`} />
      </button>
      {isOpen && (
        <div id={`accordion-content-${title.replace(/\s+/g, '-')}`} className="p-4 border-t border-gray-200 dark:border-gray-700">
          {children}
        </div>
      )}
    </div>
  );
};


const AnalysisDisplay: React.FC<AnalysisDisplayProps> = ({ analysisData, onReset }) => {
  const { t } = useTranslation();
  const { generalImpression, characteristics, routine, products, wellnessTips } = analysisData;

  const [isDownloadingPdf, setIsDownloadingPdf] = useState(false);
  const [pdfMessage, setPdfMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);


  const scrollToTop = () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleDownloadPdf = async () => {
    setIsDownloadingPdf(true);
    setPdfMessage(null);

    try {
      const doc = new jsPDF();
      const primaryColor = '#14e3eb'; // Tu color primario
      const textColor = '#333333';
      const secondaryTextColor = '#555555';
      const pageHeight = doc.internal.pageSize.getHeight();
      const pageWidth = doc.internal.pageSize.getWidth();
      const margin = 15;
      const contentWidth = pageWidth - 2 * margin;
      let yPos = margin;
      const lineHeight = 7;
      const sectionSpacing = 12; // Espacio mayor entre secciones
      const itemSpacing = 6;    // Espacio entre ítems dentro de una sección
      const cardPadding = 5;    // Relleno dentro de las "tarjetas" de características

      // --- PLACAHOLDER PARA EL LOGO (REEMPLAZA CON TU BASE64 REAL) ---
      const propielLogoBase64 = '/9j/4QC8RXhpZgAASUkqAAgAAAAGABIBAwABAAAAAQAAABoBBQABAAAAVgAAABsBBQABAAAAXgAAACgBAwABAAAAAgAAABMCAwABAAAAAQAAAGmHBAABAAAAZgAAAAAAAABgAAAAAQAAAGAAAAABAAAABgAAkAcABAAAADAyMTABkQcABAAAAAECAwAAoAcABAAAADAxMDABoAMAAQAAAP//AAACoAQAAQAAAAAEAAADoAQAAQAAAAAEAAAAAAAA/+EOM2h0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA2LTEzPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmMwNjFmYzhhLWU4Y2UtNDBlNy1iOTdkLTI4YjQ0ZWM4YTcyMzwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5EaXNlw7FvIHNpbiB0w610dWxvIC0gMTwvcmRmOmxpPgogICA8L3JkZjpBbHQ+CiAgPC9kYzp0aXRsZT4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6cGRmPSdodHRwOi8vbnMuYWRvYmUuY29tL3BkZi8xLjMvJz4KICA8cGRmOkF1dGhvcj5qb3JnZSBsZW9uPC9wZGY6QXV0aG9yPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczp4bXA9J2h0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8nPgogIDx4bXA6Q3JlYXRvclRvb2w+Q2FudmEgZG9jPURBR3FOb0hmVnBvIHVzZXI9VUFHTVdXMWsxd0kgYnJhbmQ9QkFHTVdVTGRReHcgdGVtcGxhdGU9PC94bXA6Q3JlYXRvclRvb2w+CiA8L3JkZjpEZXNjcmlwdGlvbj4KPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0ndyc/Pv/bAEMABgQFBgUEBgYFBgcHBggKEAoKCQkKFA4PDBAXFBgYFxQWFhodJR8aGyMcFhYgLCAjJicpKikZHy0wLSgwJSgpKP/bAEMBBwcHCggKEwoKEygaFhooKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKP/AABEIBAAEAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APqmiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKQso6kCgBaKYZox1cUCaM9HWgB9FIrBuhzS0AFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABXmHi34iXGj6vPZwwI3lsVyQa9Pr5w+JDf8Vhfe0jf0oA6P/ha2ok8W0P5Gg/FTUv+feH8jXm+6u6+G/hCDxGk813K6JGRgKM5zQMun4raiP8Al3g/Wm/8LX1H/n3g/WuyHwx0jHLsf+Aikb4YaQR99h/wEUCOPHxY1D/n3g/Wnr8WL7PNvDj6Gumn+FWlSLhJ5FPsorHvPhBGFJtb6Zm7BsCkBHD8W3Xm4t1x/sqa3dH+Kek3kgjmEkTHjLLgV5j4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/QNm/wC+RXoXwc0W/wBP1G4lvLSSBGTALDGea9b8mL/nmn5U9UVfuqB9BTAWiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoorE1TxJY6bP5Nwzb/Zc1UYOTtFGVWtCjHmqOyNuiuZHjHTj0aT/vml/wCEw07+8/8A3zWn1ep/Kcn9q4T/AJ+I6Wiua/4TDTv7z/8AfNJ/wmGnf3n/AO+aPq9T+UP7Vwn/AD8R01Fcz/wmOnf3n/75o/4THTv70n/fNP6vV/lF/auE/wCfiOmormP+Ex07+8//AHzS/wDCY6d/ek/75pfV6nYP7Vwn/PxHTUVzH/CY6d/ek/75oHjHTj/E/wD3zT+r1f5Q/tbCf8/EdPRXM/8ACY6f/ef/AL5o/wCEw0/+8/8A3zR9Wqdg/tbCf8/EdNRXM/8ACYaf/ef/AL5o/wCEx07+8/8A3zR9Xqdg/tXCf8/EdNRXM/8ACY6d/ef/AL5oHjHTv70n/fNL6vU7B/auE/5+I6aiuZ/4THTv70n/AHzS/wDCYad/ef8A75o+r1P5R/2rhP8An4jpaK5n/hMNO/vP/wB80f8ACY6d/ef/AL5o+r1P5Rf2rhP+fiOmormf+Ex07+8//fNJ/wAJlpo/ik/74o+r1P5R/wBq4T/n4jp6K5j/AITLTT/FJ/3xS/8ACY6d/ef/AL5o+r1P5Q/tXCf8/EdNRXM/8Jjp395/++aP+Ex07+8//fNH1ep2F/a2E/5+I6aiuZ/4THTv7z/980f8Jjp395/++aPq9T+UP7Vwn/PxHTUVzP8AwmOnf3n/AO+aP+Ex07+8/wD3zR9Xqdh/2rhP+fiOmormf+Ex07+8/wD3zR/wmOnf3n/7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RQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf//Z'; // REEMPLAZA ESTO CON EL BASE64 DE TU LOGO
       // Si no tienes el logo en Base64, puedes omitir esta línea de doc.addImage
      // y ajustar el yPos inicial.
       //doc.addImage(propielLogoBase64, 'PNG', margin, yPos, 40, 15); // Logo a la izquierda
       //yPos += 20; // Espacio después del logo
      // --- FIN PLACAHOLDER LOGO ---


      // Helper para añadir texto y manejar saltos de página y fondo de sección
      const addText = (text: string | string[], x: number, currentY: number, options: any = {}, maxWidth?: number): number => {
        const textArray = Array.isArray(text) ? text : [text];
        let newY = currentY;
        
        textArray.forEach(line => {
            if (newY + lineHeight > pageHeight - margin) {
                doc.addPage();
                newY = margin;
                // Opcional: Volver a dibujar encabezado si es multi-página
                // drawHeader(doc, newY, pageWidth, primaryColor); // Si creas una función para el encabezado
                // newY += 20; // Espacio después del encabezado de nueva página
            }
            const textToPrint = maxWidth ? doc.splitTextToSize(line, maxWidth) : [line];
            doc.text(textToPrint, x, newY, options);
            newY += (textToPrint.length * lineHeight) + (options.isTitle ? 3 : 0); // Más espacio después de títulos
        });
        return newY;
      };

      // Helper para dibujar un encabezado de sección con color de fondo
      const drawSectionHeader = (titleKey: string, currentY: number): number => {
          const title = t(titleKey);
          const headerHeight = 10; // Altura del fondo de la cabecera
          
          if (currentY + headerHeight + 5 > pageHeight - margin) { // Si no hay espacio, nueva página
              doc.addPage();
              currentY = margin;
          }

          doc.setFillColor(primaryColor); // Color de tu marca
          doc.rect(margin, currentY, contentWidth, headerHeight, 'F'); // Dibujar el fondo
          
          doc.setFontSize(14);
          doc.setTextColor(255, 255, 255); // Texto blanco sobre el fondo de color
          doc.text(title, margin + 5, currentY + headerHeight / 2 + 2, { align: 'left' }); // Texto del título centrado verticalmente

          doc.setTextColor(textColor); // Restaura el color de texto
          doc.setFontSize(11); // Restaura el tamaño de fuente
          return currentY + headerHeight + 5; // Nueva posición Y después del encabezado
      };
      
      doc.setFont('helvetica', 'normal');

      // --- ENCABEZADO MEJORADO CON LOGO CENTRADO ---
      // Ajusta estos valores para cambiar el tamaño del logo
      const logoWidth = 80; // Ancho deseado del logo en el PDF (ajústalo según necesites)
      const logoHeight = 30; // Altura deseada del logo en el PDF (ajústalo si sabes la proporción, o 0 para automático)
      const logoX = (pageWidth - logoWidth) / 2; // Calcula la posición X para centrar el logo

      // Añadir el logo
      // Reemplaza 'propielLogoBase64' con la variable que contiene tu string Base64 real.
      // El '0' en el parámetro de altura indica a jspdf que mantenga la proporción.
      doc.addImage(propielLogoBase64, 'JPEG', logoX, yPos, logoWidth, 0); // Tipo JPEG según tu Base64

      yPos += logoHeight + 40; // Espacio después del logo (ajusta el '10' si necesitas más/menos)


      // Título del Reporte (sin el texto "ProPiel" duplicado)
      doc.setFontSize(16);
      doc.setTextColor(textColor); // Color del título del reporte
      yPos = addText(t('pdfReportTitle'), margin, yPos + 2, { isTitle: true });
      
      // Fecha
      doc.setFontSize(10);
      doc.setTextColor(secondaryTextColor);
      const currentDate = new Date().toLocaleDateString(t('language') === 'es' ? 'es-ES' : 'en-US', {
        year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'
      });
      yPos = addText(t('pdfGeneratedDate', { date: currentDate }), margin, yPos + 5);
      yPos += sectionSpacing; // Espacio después del encabezado

      // --- IMPRESIÓN GENERAL (AHORA DENTRO DE LA PRIMERA SECCIÓN VISUAL) ---
      yPos = drawSectionHeader('analysisSectionCharacteristics', yPos); // Cabecera de sección con color
      doc.setFontSize(11);
      doc.setTextColor(textColor);
      if (generalImpression) {
        yPos = addText(generalImpression, margin + 5, yPos + 2, {}, contentWidth - 5);
      } else {
        yPos = addText(t('analysisGeneralImpressionDefault'), margin + 5, yPos + 2, {}, contentWidth - 5);
      }
      yPos += sectionSpacing;


      // --- CARACTERÍSTICAS DE LA PIEL (DISEÑO TIPO TARJETA) ---
      if (characteristics && characteristics.length > 0) {
        yPos = drawSectionHeader('analysisSectionCharacteristics', yPos); // Cabecera de sección con color
        yPos += 2;
        characteristics.forEach(char => {
          // Calcula si hay espacio para esta característica
          if (yPos + lineHeight * 4 + itemSpacing + cardPadding * 2 > pageHeight - margin) {
            doc.addPage();
            yPos = margin;
            yPos = drawSectionHeader('analysisSectionCharacteristics', yPos); // Repetir cabecera en nueva página
            yPos += 2;
          }

          // Dibuja un fondo de tarjeta sutil para cada característica
          doc.setFillColor(240, 240, 240); // Un gris muy claro
          doc.rect(margin, yPos, contentWidth, lineHeight * 4 + cardPadding * 2, 'F'); // Fondo de la "tarjeta"

          // --- PLACAHOLDER PARA ÍCONO DE CARACTERÍSTICA ---
          // Para integrar iconos reales aquí, necesitarías:
          // 1. Fetch la imagen del icono de Cloudinary (de getIconByKeyword).
          // 2. Convertir la imagen a formato Base64.
          // 3. Usar doc.addImage(base64Image, 'PNG', x, y, width, height).
          // Por ejemplo:
          // const iconUrl = getIconByKeyword(char.icon || char.name, ""); // Obtener URL
          // if (iconUrl && iconUrl.startsWith('https://')) {
          //   const iconData = await fetch(iconUrl).then(res => res.blob()).then(blob => {
          //     return new Promise(resolve => {
          //       const reader = new FileReader();
          //       reader.onloadend = () => resolve(reader.result);
          //       reader.readAsDataURL(blob);
          //     });
          //   });
          //   doc.addImage(iconData as string, 'PNG', margin + cardPadding, yPos + cardPadding, 10, 10);
          // }
          // yPos del texto debería ajustarse si el ícono es grande

          doc.setFont('helvetica', 'bold');
          doc.setFontSize(11);
          doc.setTextColor(textColor);
          const charName = char.nameKey ? t(char.nameKey) : char.name;
          yPos = addText(`${charName}`, margin + cardPadding, yPos + cardPadding, {}, contentWidth - cardPadding * 2);
          
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(10);
          doc.setTextColor(secondaryTextColor);
          yPos = addText(`${t('pdfScoreLabel')}: ${char.score}/100`, margin + cardPadding + 5, yPos, {}, contentWidth - cardPadding * 2 - 5);
          yPos = addText(char.description, margin + cardPadding + 5, yPos, {}, contentWidth - cardPadding * 2 - 5);
          yPos += itemSpacing + cardPadding * 2; // Espacio después de la tarjeta

        });
        yPos += sectionSpacing;
      }
      
      // --- RUTINA DE CUIDADO ---
      if (routine && routine.length > 0) {
        yPos = drawSectionHeader('analysisSectionRoutine', yPos);
        yPos += 2;

        const morningRoutine = routine.filter(r => r.time === 'Morning').sort((a,b) => a.step - b.step);
        const eveningRoutine = routine.filter(r => r.time === 'Evening').sort((a,b) => a.step - b.step);

        if (morningRoutine.length > 0) {
          if (yPos > pageHeight - margin - 20) { doc.addPage(); yPos = margin; yPos = drawSectionHeader('routineMorning', yPos);}
          doc.setFont('helvetica', 'bold');
          doc.setFontSize(12);
          doc.setTextColor(textColor);
          yPos = addText(t('routineMorning'), margin, yPos);
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(10);
          doc.setTextColor(secondaryTextColor);
          morningRoutine.forEach(step => {
            if (yPos > pageHeight - margin - 20) { doc.addPage(); yPos = margin; yPos = drawSectionHeader('routineMorning', yPos);}
            let stepText = `${step.step}. ${step.description}`;
            if (step.productType) stepText += ` (${step.productType})`;
            yPos = addText(stepText, margin + 5, yPos, {}, contentWidth - 5);
          });
          yPos += itemSpacing;
        }

        if (eveningRoutine.length > 0) {
          if (yPos > pageHeight - margin - 20) { doc.addPage(); yPos = margin; yPos = drawSectionHeader('routineEvening', yPos);}
          doc.setFont('helvetica', 'bold');
          doc.setFontSize(12);
          doc.setTextColor(textColor);
          yPos = addText(t('routineEvening'), margin, yPos);
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(10);
          doc.setTextColor(secondaryTextColor);
          eveningRoutine.forEach(step => {
            if (yPos > pageHeight - margin - 20) { doc.addPage(); yPos = margin; yPos = drawSectionHeader('routineEvening', yPos);}
            let stepText = `${step.step}. ${step.description}`;
            if (step.productType) stepText += ` (${step.productType})`;
            yPos = addText(stepText, margin + 5, yPos, {}, contentWidth - 5);
          });
          yPos += itemSpacing;
        }
        yPos += sectionSpacing;
      }

      // --- RECOMENDACIONES DE PRODUCTOS ---
      if (products && products.length > 0) {
        yPos = drawSectionHeader('analysisSectionProducts', yPos);
        yPos += 2;
        products.forEach(prod => {
          if (yPos > pageHeight - margin - 30) { doc.addPage(); yPos = margin; yPos = drawSectionHeader('analysisSectionProducts', yPos);}
          doc.setFont('helvetica', 'bold');
          doc.setFontSize(11);
          doc.setTextColor(textColor);
          yPos = addText(`• ${prod.name || 'Product Name'}`, margin, yPos, {}, contentWidth);
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(10);
          doc.setTextColor(secondaryTextColor);
          yPos = addText(`  ${t('Type')}: ${prod.type || 'N/A'}`, margin, yPos, {}, contentWidth);
          yPos = addText(`  ${t('Reason')}: ${prod.reason || 'N/A'}`, margin, yPos, {}, contentWidth);
          yPos += itemSpacing;
        });
        yPos += sectionSpacing;
      }

      // --- CONSEJOS DE BIENESTAR ---
      if (wellnessTips && wellnessTips.length > 0) {
        yPos = drawSectionHeader('analysisSectionWellness', yPos);
        yPos += 2;
        wellnessTips.forEach(tip => {
          if (yPos > pageHeight - margin - 20) { doc.addPage(); yPos = margin; yPos = drawSectionHeader('analysisSectionWellness', yPos);}
          doc.setFont('helvetica', 'bold');
          doc.setFontSize(11);
          doc.setTextColor(textColor);
          const categoryName = tip.categoryKey ? t(tip.categoryKey) : tip.category;
          yPos = addText(`• ${categoryName}`, margin, yPos, {}, contentWidth);
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(10);
          doc.setTextColor(secondaryTextColor);
          yPos = addText(`  ${tip.tip}`, margin + 5, yPos, {}, contentWidth - 5);
          yPos += itemSpacing;
        });
        yPos += sectionSpacing;
      }

      // --- PIE DE PÁGINA (Paginación y Descargo de Responsabilidad) ---
      const totalPages = doc.getNumberOfPages(); 
      for (let i = 1; i <= totalPages; i++) {
          doc.setPage(i);
          // Número de página
          doc.setFontSize(8);
          doc.setTextColor(secondaryTextColor);
          doc.text(`${i}/${totalPages}`, pageWidth - margin - 5, pageHeight - margin + 5, { align: 'right' });

          // Descargo de responsabilidad en el pie de página
          doc.setFontSize(8);
          doc.setTextColor(secondaryTextColor);
          const disclaimerText = doc.splitTextToSize(t('analysisDisclaimer'), contentWidth - 10); // Más pequeño para el pie
          doc.text(disclaimerText, margin + 5, pageHeight - margin + 5, { align: 'left' });
      }

      const filename = `ProPiel_Analysis_${new Date().toISOString().split('T')[0]}.pdf`;
      
      // --- INICIO DE LA MODIFICACIÓN REAL (Capacitor File System) ---
      if (Capacitor.isNativePlatform()) {
        const pdfOutput = doc.output('datauristring');
        const pdfBase64Data = pdfOutput.split(',')[1];

        try {
          // Guardar el archivo
          const savedFile = await Filesystem.writeFile({
            path: filename,
            data: pdfBase64Data,
            directory: Directory.Documents, 
            recursive: true 
          });

          // Si se guardó correctamente, intentar abrirlo
          if (savedFile.uri) {
            await FileOpener.open({
              filePath: savedFile.uri, 
              contentType: 'application/pdf',
              openWithDefault: true, 
            });
            setPdfMessage({ type: 'success', text: t('pdfSuccessMessage') + ' ' + t('pdfOpening') }); 
          } else {
            setPdfMessage({ type: 'error', text: t('pdfErrorMessage') + ' (' + t('pdfNoUri') + ')' }); 
          }

        } catch (e: any) {
          console.error("Error al guardar o abrir PDF en dispositivo:", e);
          let errorMessage = t('pdfErrorMessage') + ' (' + t('pdfStorageError') + ')'; 
          if (e.message.includes('Permission denied')) {
              errorMessage = t('pdfErrorMessage') + ' (' + t('pdfPermissionDenied') + ')'; 
          }
          setPdfMessage({ type: 'error', text: errorMessage });
        }
      } else {
        // Lógica para navegadores web (lo que ya tenías con doc.save)
        doc.save(filename);
        setPdfMessage({ type: 'success', text: t('pdfSuccessMessage') });
      }
      // --- FIN DE LA MODIFICACIÓN REAL ---

    } catch (error: any) {
      console.error("Failed to generate PDF:", error);
      setPdfMessage({ type: 'error', text: t('pdfErrorMessage') + ': ' + (error.message || t('error.unknown')) }); 
    } finally {
      setIsDownloadingPdf(false);
    }
  };

  return (
    // ... (rest of the component JSX, which is already good) ...
    <div className="container mx-auto p-4 space-y-6 sm:space-y-8 max-w-4xl">
      <div className="text-center mb-6 sm:mb-8">
        <h2
          onClick={scrollToTop}
          className="text-2xl sm:text-3xl font-bold text-primary dark:text-[#14e3eb] mb-2 cursor-pointer hover:opacity-80 transition-opacity"
          role="button"
          tabIndex={0}
          onKeyPress={(e) => (e.key === 'Enter' || e.key === ' ') && scrollToTop()}
          aria-label={t('analysisResultsTitle')}
        >
          {t('analysisResultsTitle')}
        </h2>
        <p className="text-sm sm:text-base text-gray-700 dark:text-gray-300 px-2 break-words">
          {generalImpression || t('analysisGeneralImpressionDefault')}
        </p>
      </div>

      <AccordionSection titleKey="analysisSectionCharacteristics" icon={<InfoIcon className="w-5 h-5 sm:w-6 sm:h-6 text-primary dark:text-[#14e3eb]" />}>
        <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
          {characteristics && characteristics.length > 0 ? (
            characteristics.map((char, index) => (
              <SkinCharacteristicCard key={char.nameKey || char.name || index} characteristic={char} />
            ))
          ) : <p className="col-span-full text-gray-600 dark:text-gray-400 text-sm">{t('analysisNoCharacteristics')}</p>}
        </div>
      </AccordionSection>
      
      <AccordionSection titleKey="analysisSectionRoutine" icon={<InfoIcon className="w-5 h-5 sm:w-6 sm:h-6 text-primary dark:text-[#14e3eb]" />}>
        {routine && routine.length > 0 ? (
          <SkincareRoutineSection routine={routine} />
        ) : <p className="text-gray-600 dark:text-gray-400 text-sm">{t('analysisNoRoutine')}</p>}
      </AccordionSection>

      <AccordionSection titleKey="analysisSectionProducts" icon={<InfoIcon className="w-5 h-5 sm:w-6 sm:h-6 text-primary dark:text-[#14e3eb]" />}>
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6">
          {products && products.length > 0 ? (
            products.map((product, index) => (
              <ProductRecommendationCard key={product.name || index} product={product} />
            ))
          ) : <p className="col-span-full text-gray-600 dark:text-gray-400 text-sm">{t('analysisNoProducts')}</p>}
        </div>
      </AccordionSection>
      
      <AccordionSection titleKey="analysisSectionWellness" icon={<InfoIcon className="w-5 h-5 sm:w-6 sm:h-6 text-primary dark:text-[#14e3eb]" />}>
        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
          {wellnessTips && wellnessTips.length > 0 ? (
            wellnessTips.map((tip, index) => (
              <WellnessTipCard key={tip.tip || index} tip={tip} />
            ))
          ) : <p className="col-span-full text-gray-600 dark:text-gray-400 text-sm">{t('analysisNoWellnessTips')}</p>}
        </div>
      </AccordionSection>

      <div className="text-center mt-8 sm:mt-12 flex flex-col items-center space-y-3">
        <div className="flex flex-col sm:flex-row justify-center items-center space-y-3 sm:space-y-0 sm:space-x-4 w-full sm:w-auto">
            <button
            onClick={onReset} 
            className="px-6 py-2.5 sm:px-8 sm:py-3 bg-primary text-primary-content font-semibold rounded-lg hover:bg-opacity-90 transition-colors text-sm sm:text-base w-full sm:w-auto"
            aria-label={t('analysisReturnHomeButton')}
            >
            {t('analysisReturnHomeButton')}
            </button>
            <button
                onClick={handleDownloadPdf}
                disabled={isDownloadingPdf}
                className="flex items-center justify-center space-x-2 px-6 py-2.5 sm:px-8 sm:py-3 bg-gray-600 text-white font-semibold rounded-lg hover:bg-gray-500 transition-colors text-sm sm:text-base w-full sm:w-auto disabled:opacity-50"
                aria-label={t('analysisDownloadPdfButton')}
            >
                <DownloadIcon className="w-5 h-5" />
                <span>
                    {isDownloadingPdf ? `${t('loadingAnalysis').split(' ')[0]}...` : t('analysisDownloadPdfButton')}
                </span>
                {isDownloadingPdf && <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin ml-2"></div>}
            </button>
        </div>
        {pdfMessage && (
            <p className={`text-xs mt-3 ${pdfMessage.type === 'success' ? 'text-primary dark:text-[#14e3eb]' : 'text-red-600 dark:text-red-400'}`}>
                {pdfMessage.text}
            </p>
        )}
      </div>
       <p className="text-xs text-center text-gray-500 dark:text-gray-400 mt-6 sm:mt-8 px-2">
        {t('analysisDisclaimer')}
      </p>
    </div>
  );
};

export default AnalysisDisplay;